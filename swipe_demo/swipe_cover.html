<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0" />

<title>swipe demo</title>
<style type="text/css">
*{margin:0px;padding:0px;}
html{width:100%;height:100%;overflow:hidden;}
body{width:100%;height:100%;position:relative;}
.container{width:100%;height:100%;}
.main_page{width:100%;
/*开启手机硬件加速*/
-webkit-backface-visibility: hidden;
-webkit-transform-style:preserve-3d;
position:absolute;
z-index:0;
display:-webkit-box;
-webkit-box-pack:center;
-webkit-box-align:center;

-webkit-transform-origin:center top;

background:#fff;
}
.main_page img{
	width:100%;
	height:auto;
}
.black{background:#000;}
</style>
</head>
<body>
	<div class="container" id="container">
		<div class="main_page"><img src="http://jiangsu.china.com.cn/uploadfile/2012/1119/20121119032016862.jpg" alt=""></div>
		<div class="main_page"><img src="http://img.pconline.com.cn/images/product/4710/471016/iPhone6.jpg" alt=""></div>
		<div class="main_page black"><img src="http://img.jrjimg.cn/2010/10/20101021140328542.jpg" alt=""></div>
		<div class="main_page"><img src="http://wenwen.sogou.com/p/20100825/20100825180041-1835810978.jpg" alt=""></div>
	</div>
	<script type="text/javascript">
	(function(){
		var common={
			//class do somthing
			getByClass:function(oParent,sClass){
				var aChild = oParent.getElementsByTagName('*');
		        var result = [];
			    for(var i =0;i<aChild.length;i++){
			        if(aChild[i].className.match(new RegExp("(\\s|^)" + sClass+ "(\\s|$)"))){ //判断是否有该class
			            result.push(aChild[i]);
			        };
			    };
			    return result;
			},
			hasClass:function(obj, cls){
				return obj.className.match(new RegExp('(\\s|^)' + cls + '(\\s|$)'));  
			},

			addClass:function(obj, cls){
				if (!this.hasClass(obj, cls)) obj.className += " " + cls;  
			},
			removeClass:function(obj, cls){
				if (this.hasClass(obj, cls)) {  
			        var reg=new RegExp('(\\s|^)' +cls+ '(\\s|$)');  
			        obj.className = obj.className.replace(reg, '');  
			    }  
			}
		}
		var container=document.getElementById('container');
		var main_page=common.getByClass(container,'main_page');
		var H=window.innerHeight;
		var idx=0;//索引
		var count=main_page.length;
		var startY=0;
		var scrollY=0;//页面初始位置
		var transY=0;//变化的值
		var disY=0;
		var next=0;
		var prev=0;
		// 当前张  transformY 为 0  当前的 上一张的 transformY 为 -667  当前张的 下一张的transformY 为667
	    for(var i=0;i<main_page.length;i++){
	    	main_page[i].style.height=H+'px';
	    	main_page[1].style['z-index']=1;
	    	main_page[3].style['z-index']=1;
	    	main_page[0].style['z-index']=2;
	    	main_page[1].style['-webkit-transform']='translate3d(0px,'+H+'px,0px)';
	    	main_page[3].style['-webkit-transform']='translate3d(0px,'+-H+'px,0px)';
	    	main_page[0].style['-webkit-transform']='translate3d(0px,'+0+'px,0px)';
	    }
	    var startHandle=function(ev){
	    	startY=ev.changedTouches[0].pageY;
	    	scrollY=transY;

	    	if(idx==0){
	    		next=idx+1;
	    		prev=count-1;
	    	}else if(idx==count-1){
	    		next=0;
	    		prev=idx-1;
	    	}else{
	    		next=idx+1;
	    		prev=idx-1;
	    	}
	    	for(var i=0;i<main_page.length;i++){
	    		main_page[i].style['-webkit-transition']='none';
	    	}
	    	main_page[prev].style['z-index']=2;
	    	main_page[next].style['z-index']=2;
	    	main_page[idx].style['z-index']=1;
	    	main_page[idx].style['-webkit-transform']='translate3d(0px,'+0+'px,0px)';
	    	main_page[prev].style['-webkit-transform']='translate3d(0px,'+-H+'px,0px)';
	    	main_page[next].style['-webkit-transform']='translate3d(0px,'+H+'px,0px)';

	    }
	    var moveHandle=function(ev){
	    	disY=ev.changedTouches[0].pageY-startY;
	    	transY=scrollY+disY;
	   		if(transY<0){
	   			
	   			main_page[next].style['-webkit-transform']='translate3d(0px,'+(transY+H)+'px,0px)';
	   			main_page[prev].style['-webkit-transform']='translate3d(0px,'+-H+'px,0px)';
	   		}else{
	   			
	   			main_page[prev].style['-webkit-transform']='translate3d(0px,'+(transY-H)+'px,0px)';
	   			main_page[next].style['-webkit-transform']='translate3d(0px,'+H+'px,0px)';
	   		}
	    	
	    }
	    var endHandle=function(ev){
	    	if(transY<0&&Math.abs(disY)>50){
	    		transY=0;
	    		main_page[next].style['-webkit-transform']='translate3d(0px,'+transY+'px,0px)';
	    		main_page[next].style['-webkit-transition']='all 0.4s ease-out';
	    		idx++;
	    		if(idx>count-1){
	    			idx=0;
	    		}
	    	}else if(transY>0&&Math.abs(disY)>50){
	    		transY=0;
	    		main_page[prev].style['-webkit-transform']='translate3d(0px,'+transY+'px,0px)';
	    		main_page[prev].style['-webkit-transition']='all 0.4s ease-out';
	    		idx--;
	    		if(idx<0){
	    			idx=count-1;
	    		}
	    	}else{
	    		main_page[next].style['-webkit-transform']='translate3d(0px,'+H+'px,0px)';
	    		main_page[next].style['-webkit-transition']='all 0.4s ease-out';
	    		main_page[prev].style['-webkit-transform']='translate3d(0px,'+-H+'px,0px)';
	    		main_page[prev].style['-webkit-transition']='all 0.4s ease-out';
	    	}
	    	
	    }
	    function transformY(obj,dis){
	    	obj.style['-webkit-transform']='translate3d(0px,'+dis+'px,0px)';
	    }
	    container.addEventListener('touchstart',startHandle,false);
	    container.addEventListener('touchmove',moveHandle,false);
	    container.addEventListener('touchend',endHandle,false);
	    document.addEventListener('touchmove',function(ev){
	    	ev.preventDefault();
	    },false);

	})();	
	</script>
</body>
</html>